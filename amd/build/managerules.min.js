define("gradereport_calcsetup/managerules",["exports","core/ajax","core/modal_factory","core/modal_events","core/str"],(function(_exports,Ajax,ModalFactory,ModalEvents,Str){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}
/**
   * @file       UI scripts for Grade Calculation Setup Tool.
   * @copyright  Te Wānanga o Aotearoa
   * @author     Jeremy FitzPatrick
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,Ajax=_interopRequireWildcard(Ajax),ModalFactory=_interopRequireWildcard(ModalFactory),ModalEvents=_interopRequireWildcard(ModalEvents),Str=_interopRequireWildcard(Str);_exports.init=()=>{document.getElementById("rulestable").addEventListener("click",editrule)};const editrule=evt=>{let el=evt.target;if("I"===el.nodeName)el=el.parentElement;else if("A"!==el.nodeName)return;let cls=el.getAttribute("class");if(cls.includes("showhide"))hiderule(el);else{if(!cls.includes("delete"))return;deleterule(el)}evt.preventDefault()},hiderule=el=>{let ruleid=el.dataset.ruleid||0,action=el.dataset.action;Str.get_strings([{key:"hide"},{key:"show"}]).done((function(strings){Ajax.call([{methodname:"gradereport_calcsetup_hiderule",args:{id:ruleid,action:action},done:function(data){if(!1!==data.success)if(1==action){let hide=strings[0];el.innerHTML="<i class='icon fa fa-eye fa-fw' title='"+hide+"' aria-label='"+hide+"'></i>",el.dataset.action=0}else{let show=strings[1];el.innerHTML="<i class='icon fa fa-eye-slash fa-fw' title='"+show+"' aria-label='"+show+"'></i>",el.dataset.action=1}}}])}))},deleterule=el=>{let ruleid=el.dataset.ruleid||0;return ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,body:Str.get_string("deleterulereally","gradereport_calcsetup"),title:Str.get_string("deleterule","gradereport_calcsetup"),removeOnClose:!0,buttons:{save:Str.get_string("yes"),cancel:Str.get_string("no")}}).then((function(modal){return modal.getRoot().on(ModalEvents.save,(function(){Ajax.call([{methodname:"gradereport_calcsetup_deleterule",args:{id:ruleid},done:function(data){if(!1===data.success)return!1;return el.parentNode.parentNode.remove(),!0}}])})),modal.show(),!0}))}}));

//# sourceMappingURL=managerules.min.js.map